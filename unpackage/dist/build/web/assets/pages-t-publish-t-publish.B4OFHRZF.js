import{l as e,r as l,m as a,p as s,h as t,a as u,w as o,c,j as n,F as i,i as d,S as r,o as p,b as v,t as m,u as f,d as h,k as g,s as _,n as x,f as y,I as w,q as k,P as C,v as b}from"./index-CfP6DwfA.js";import{s as V,f as L}from"./index.jXFTdHRt.js";import{o as F}from"./uni-app.es._R_BQDpV.js";import{u as j}from"./useMainStore.xCEnPSxB.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='6'%20height='6'%20viewBox='0%200%206%206'%3e%3cg%3e%3cpath%20d='M1.93194,6L0.675393,5.04132L2.08901,3.35537L0,2.89256L0.486911,1.33884L2.43456,2.24793L2.21466,0L3.78534,0L3.54974,2.24793L5.51309,1.33884L6,2.89256L3.89529,3.35537L5.32461,5.04132L4.08377,6L3,4.03306L1.93194,6Z'%20fill='%23FC0402'%20fill-opacity='1'/%3e%3c/g%3e%3c/svg%3e",U="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_17_29107'%3e%3crect%20x='0'%20y='0'%20width='24'%20height='24'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_17_29107)'%3e%3cg%20transform='matrix(0.7071067690849304,-0.7071067690849304,0.7071067690849304,0.7071067690849304,-8.485292692961764,3.514723519501615)'%3e%3cg%3e%3crect%20x='0'%20y='19.54274082183838'%20width='16.970455169677734'%20height='1.8856195211410522'%20rx='0.9428097605705261'%20fill='%23D8D8D8'%20fill-opacity='1'/%3e%3c/g%3e%3cg%20transform='matrix(0,1,-1,0,21.42775058746338,2.572281837463379)'%3e%3crect%20x='9.427734375'%20y='12.000016212463379'%20width='16.9705753326416'%20height='1.885606050491333'%20rx='0.9428030252456665'%20fill='%23D8D8D8'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",E=S({__name:"t-publish",setup(S){const E=j();e();let q=l("");const B=l(""),M=l(""),P=l(""),z=l(""),A=l("");let Z=l(!0),N=l([]),I=l([]),T=l(0);const O=l(!1),R=l(!1),$=l(!1),G=l("height: 50px; color: #007aff;"),H=l(null);l(1);const J=l(0),K=l("");function Q(){O.value=!1,R.value=!1,$.value=!1,W.value=!1}const W=l(!1),X=l([0]),Y=l([]);for(let e=1;e<100;e++)Y.value.push(e);const ee=l(null),le=l(null);function ae(e){X.value=e.detail.value,ee.value=Y.value[e.detail.value[0]],console.log(ee.value)}function se(){W.value=!0}function te(){H.value=ee.value,Q()}function ue(){!async function(){let e=Z.value?0:1,l=[];N.value.forEach(((e,a)=>{l.push(e.name)}));let a={projectpracticename:q.value,title:B.value,content:M.value,guidance:P.value+"&&"+z.value,resultdisplay:A.value,studentrequirements:H.value,releasestatus:1,budgetsrouce:e,majortograde:{},budge:J.value,appointstudent:l},s=await V(a);console.log(s,"aaahhhhhhh"),Q(),"success"==s.data.message?(_({title:"题目已发布!",icon:"success",duration:1e3}),setTimeout((()=>{x({url:"/pages/t-index/t-index"})}),1e3)):_({title:"题目发布失败!",icon:"error",duration:1e3})}()}function oe(){$.value=!0}a((()=>{}));const ce={title:B,content:M,place:P,time:z,stunum:H,resultdisplay:A};async function ne(){let e=Z.value?0:1,l=[];N.value.forEach(((e,a)=>{l.push(e.name)}));let a={projectpracticename:q.value,title:B.value,content:M.value,guidance:P.value+"&&"+z.value,resultdisplay:A.value,studentrequirements:H.value,releasestatus:0,budgetsrouce:e,majortograde:{},budge:J.value,appointstudent:l},s=await V(a);console.log(s,"zan"),"success"==s.data.message?(_({title:"题目已暂存!",icon:"success",duration:1e3}),setTimeout((()=>{x({url:"/pages/t-index/t-index"})}),1e3)):_({title:"题目暂存失败",icon:"error",duration:1e3})}return F((()=>{console.log(E.profession,E.shareCopy,"ssss"),q.value=E.profession;let e=E.shareCopy;if(null!=E.shareCopy){B.value=e.title,M.value=e.content;let l=e.guidance.split("&&"),[a,s]=l;P.value=a,z.value=s,A.value=e.resultDisplay,H.value=e.studentRequirements,Z.value=0!=e.budgetsrouce,J.value=e.budget,null!=e.Enrolls&&e.Enrolls.forEach(((e,l)=>{N.value.push({name:e.Student.name,num:e.Student.sno,pros:e.Student.majorName,ban:e.Student.class,phone:e.Student.phone})})),E.setCopyData(null)}})),(e,l)=>{const a=d,x=y,V=w,F=k,j=r,S=C,E=b,ee=s("uni-popup");return p(),t(i,null,[u(j,{class:"containers","scroll-y":"true"},{default:o((()=>[u(a,{class:"headers"},{default:o((()=>[v(m(f(q)),1)])),_:1}),u(a,{style:{width:"90vw","margin-left":"5vw"}},{default:o((()=>[u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 1. 题目 ")])),_:1}),u(a,{class:"inputs"},{default:o((()=>[u(V,{type:"text",placeholder:"请输入","placeholder-class":"placeholderStyle",modelValue:B.value,"onUpdate:modelValue":l[0]||(l[0]=e=>B.value=e)},null,8,["modelValue"])])),_:1}),u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 2. 项目内容 ")])),_:1}),u(a,{class:"inputss"},{default:o((()=>[u(F,{class:"textarea",maxlength:"200",placeholder:"请输入(200字以内)","placeholder-class":"placeholderStyle",modelValue:M.value,"onUpdate:modelValue":l[1]||(l[1]=e=>M.value=e)},null,8,["modelValue"])])),_:1}),u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 3. 教师指导内容及方式 ")])),_:1}),u(a,{class:"inputs"},{default:o((()=>[u(V,{type:"text",placeholder:"地点","placeholder-class":"placeholderStyle",modelValue:P.value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.value=e)},null,8,["modelValue"])])),_:1}),u(a,{class:"inputs"},{default:o((()=>[u(V,{type:"text",placeholder:"时间","placeholder-class":"placeholderStyle",modelValue:z.value,"onUpdate:modelValue":l[3]||(l[3]=e=>z.value=e)},null,8,["modelValue"])])),_:1}),u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 4. 最终成果展现要求 ")])),_:1}),u(a,{class:"inputss"},{default:o((()=>[u(F,{class:"textarea",modelValue:A.value,"onUpdate:modelValue":l[4]||(l[4]=e=>A.value=e),maxlength:"200",placeholder:"请输入(200字以内)","placeholder-class":"placeholderStyle"},null,8,["modelValue"])])),_:1}),u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 5. 学生人数要求 ")])),_:1}),u(a,{class:"inputs",onClick:se},{default:o((()=>[u(V,{type:"text",readonly:"true",value:H.value,placeholder:"请选择","placeholder-class":"placeholderStyle"},null,8,["value"])])),_:1}),u(a,{class:"theme"},{default:o((()=>[u(x,{src:D,mode:""}),v(" 6.项目费用预算 ")])),_:1}),u(a,{class:"xuan",onClick:l[5]||(l[5]=e=>h(Z)?Z.value=!0:Z=!0)},{default:o((()=>[u(x,{src:f(Z)?"/static/7.svg":"/static/77.svg",mode:""},null,8,["src"]),v(" 利用现有资源，不用经费 ")])),_:1}),u(a,{class:"xuan",onClick:l[6]||(l[6]=e=>h(Z)?Z.value=!1:Z=!1)},{default:o((()=>[u(x,{src:f(Z)?"/static/77.svg":"/static/7.svg",mode:""},null,8,["src"]),v(" 申请学院教学实验经费 ")])),_:1}),f(Z)?n("",!0):(p(),c(a,{key:0,class:"inputs"},{default:o((()=>[u(V,{type:"text",placeholder:"请填写经费预算金额","placeholder-class":"placeholderStyle",modelValue:J.value,"onUpdate:modelValue":l[7]||(l[7]=e=>J.value=e)},null,8,["modelValue"])])),_:1})),u(a,{class:"theme",style:{display:"flex","margin-bottom":"20px"}},{default:o((()=>[v(" 7. 指定意向学生 "),u(a,{class:"zzz"},{default:o((()=>[v("(选填)")])),_:1}),u(a,{class:"pi",style:{color:"#999CA2",position:"absolute",right:"22vw"}},{default:o((()=>[v("批量删除")])),_:1}),u(a,{class:"pi",style:{color:"#5279F2",position:"absolute",right:"5vw"}},{default:o((()=>[v("批量导入")])),_:1})])),_:1}),(p(!0),t(i,null,g(f(N),((e,l)=>(p(),c(a,{class:"stus",key:l},{default:o((()=>[u(a,null,{default:o((()=>[u(a,{class:"name"},{default:o((()=>[v(m(e.name),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("学号："+m(e.num),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("专业："+m(e.pros),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("班级："+m(e.ban),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("电话："+m(e.phone),1)])),_:2},1024)])),_:2},1024),u(a,null,{default:o((()=>[u(a,{class:"edit",onClick:e=>(R.value=!0,h(T)?T.value=l:T=l)},{default:o((()=>[v("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),u(a,{class:"addstu",onClick:oe},{default:o((()=>[u(x,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%3e%3cg%3e%3cg%3e%3cellipse%20cx='8'%20cy='8'%20rx='8'%20ry='8'%20fill='%232277F8'%20fill-opacity='1'/%3e%3c/g%3e%3cg%3e%3crect%20x='4'%20y='7'%20width='8'%20height='2'%20rx='1'%20fill='%23FFFFFF'%20fill-opacity='1'/%3e%3c/g%3e%3cg%20transform='matrix(0,1,-1,0,13,-5)'%3e%3crect%20x='9'%20y='4'%20width='8'%20height='2'%20rx='1'%20fill='%23FFFFFF'%20fill-opacity='1'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",mode:""}),v(" 添加学生 ")])),_:1}),u(a,{style:{display:"flex","justify-content":"space-around","margin-top":"55px"}},{default:o((()=>[u(a,{class:"chun",onClick:ne},{default:o((()=>[v(" 暂存 ")])),_:1}),u(a,{class:"pub",onClick:l[8]||(l[8]=e=>function(){let e=!0;for(let a of Object.keys(ce)){const s=ce[a];l=s.value,console.log(l),(""==l||null==l)&&(console.warn(`${s} is empty`),e=!1)}var l;e?O.value=!0:_({title:"请填写完整信息!",icon:"error",duration:1e3})}())},{default:o((()=>[v(" 发布 ")])),_:1})])),_:1})])),_:1})])),_:1}),O.value?(p(),c(a,{key:0,class:"mask"},{default:o((()=>[u(a,{class:"modal"},{default:o((()=>[u(a,{class:"dels",onClick:l[9]||(l[9]=e=>ue())},{default:o((()=>[v(" 确认发布 ")])),_:1}),u(a,{class:"footer",onClick:Q},{default:o((()=>[v(" 取消 ")])),_:1})])),_:1})])),_:1})):n("",!0),R.value?(p(),c(a,{key:1,class:"mask"},{default:o((()=>[u(a,{class:"modal"},{default:o((()=>[u(a,{class:"dels",onClick:l[10]||(l[10]=e=>(console.log(T.value),T.value>=0&&T.value<N.value.length&&N.value.splice(T.value,1),void Q()))},{default:o((()=>[v(" 确认删除 ")])),_:1}),u(a,{class:"footer",onClick:Q},{default:o((()=>[v(" 取消 ")])),_:1})])),_:1})])),_:1})):n("",!0),W.value?(p(),c(a,{key:2,class:"mask"})):n("",!0),W.value?(p(),c(ee,{key:3,ref_key:"pickerView",ref:le,style:{width:"100vw",position:"fixed",bottom:"0"}},{default:o((()=>[u(a,{class:"popup-view"},{default:o((()=>[u(a,{class:"popup-view-header"},{default:o((()=>[v(" 选择可选课学生人数 "),u(x,{onClick:Q,src:U,mode:""})])),_:1}),u(E,{"indicator-style":G.value,value:X.value,onChange:ae,class:"picker-view"},{default:o((()=>[u(S,null,{default:o((()=>[(p(!0),t(i,null,g(Y.value,((e,l)=>(p(),c(a,{class:"item",key:l},{default:o((()=>[v(m(e),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["indicator-style","value"]),u(a,{class:"qur",onClick:te},{default:o((()=>[v("确认")])),_:1})])),_:1})])),_:1},512)):n("",!0),$.value?(p(),c(a,{key:4,class:"mask"})):n("",!0),$.value?(p(),c(ee,{key:5,ref_key:"pickerView",ref:le,style:{width:"100vw",position:"fixed",bottom:"0"}},{default:o((()=>[u(a,{class:"popup-views"},{default:o((()=>[u(a,{class:"popup-view-header"},{default:o((()=>[v(" 选择学生 "),u(x,{onClick:Q,src:U,mode:""})])),_:1}),u(a,{class:"search"},{default:o((()=>[u(x,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_17_06661/17_06363'%3e%3crect%20x='0'%20y='0'%20width='24'%20height='24'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_17_06661/17_06363)'%3e%3cg%3e%3cpath%20d='M11.11995849609375,20.72001953125C5.83995849609375,20.72001953125,1.51995849609375,16.400019531250003,1.51995849609375,11.12001953125C1.51995849609375,5.84001953125,5.83995849609375,1.52001953125,11.11995849609375,1.52001953125C16.399958496093753,1.52001953125,20.71995849609375,5.84001953125,20.71995849609375,11.12001953125C20.71995849609375,16.400019531250003,16.399958496093753,20.72001953125,11.11995849609375,20.72001953125ZM11.11995849609375,19.12001953125C15.51995849609375,19.12001953125,19.11995849609375,15.52001953125,19.11995849609375,11.12001953125C19.11995849609375,6.72001953125,15.51995849609375,3.12001953125,11.11995849609375,3.12001953125C6.71995849609375,3.12001953125,3.11995849609375,6.72001953125,3.11995849609375,11.12001953125C3.11995849609375,15.52001953125,6.71995849609375,19.12001953125,11.11995849609375,19.12001953125ZM17.03995849609375,20.40001953125C16.71995849609375,20.08001953125,16.79995849609375,19.52001953125,17.11995849609375,19.28001953125C17.43995849609375,19.04001953125,17.99995849609375,19.04001953125,18.23995849609375,19.36001953125L19.75995849609375,21.20001953125C20.07995849609375,21.52001953125,19.99995849609375,22.08001953125,19.67995849609375,22.32001953125C19.35995849609375,22.56001953125,18.79995849609375,22.56001953125,18.55995849609375,22.24001953125L17.03995849609375,20.40001953125Z'%20fill='%239A9B9D'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",mode:""}),u(V,{type:"text",placeholder:"输入学生姓名搜索",modelValue:K.value,"onUpdate:modelValue":l[11]||(l[11]=e=>K.value=e)},null,8,["modelValue"]),u(a,{class:"sss",onClick:l[12]||(l[12]=e=>async function(){let e=await L(K.value);if(I.value=[],"failed"==e.data.message)_({title:"搜索失败",icon:"error",duration:1e3});else{let l=e.data.Studentinfo;Array.isArray(l)?l.forEach(((e,l)=>{I.value.push({name:e.name,num:e.sno,pros:e.majorName,ban:e.class,phone:e.phone})})):I.value.push({name:l.name,num:l.sno,pros:l.majorName,ban:l.class,phone:l.phone})}}())},{default:o((()=>[v("搜索")])),_:1})])),_:1}),(p(!0),t(i,null,g(f(I),((e,l)=>(p(),c(a,{class:"stus",key:l,style:{width:"86vw",padding:"16px 0","margin-left":"7vw","margin-top":"15px"},onClick:e=>{return a=l,Q(),N.value.push(I.value[a]),I.value=[],void(K.value="");var a}},{default:o((()=>[u(a,{style:{"margin-left":"16px"}},{default:o((()=>[u(a,{class:"name"},{default:o((()=>[v(m(e.name),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("学号："+m(e.num),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("专业："+m(e.pros),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("班级："+m(e.ban),1)])),_:2},1024),u(a,{class:"msg"},{default:o((()=>[v("电话："+m(e.phone),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},512)):n("",!0)],64)}}},[["__scopeId","data-v-6e2bbfc0"]]);export{E as default};
